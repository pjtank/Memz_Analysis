Memz Malware Indicator Analysis Breakdown

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Reading Specific Virtual Machine Registry Keys

"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_INNOTEK_GMBH&FAM_VIRTUAL_MACHINE&PROD_VIRTUALBOX"; Key: "PHANTOM")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_INNOTEK_GMBH&FAM_VIRTUAL_MACHINE&PROD_VIRTUALBOX"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_INNOTEK_GMBH&FAM_VIRTUAL_MACHINE&PROD_VIRTUALBOX\PROPERTIES\{83DA6326-97A6-4088-9453-A1923F573B29}\000A"; Key: "")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_INNOTEK_GMBH&FAM_VIRTUAL_MACHINE&PROD_VIRTUALBOX\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005"; Key: "")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005"; Key: "")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005"; Key: "")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005"; Key: "")

Breakdown:
The provided code snippets seem to describe Windows Registry operations involving the process mmc.exe (Microsoft Management Console). Here's a breakdown of the key elements:

General Context:
Registry Paths:

The registry paths all fall under HKLM\SYSTEM\CONTROLSET001\ENUM\, which is part of the Windows Registry hive used to manage hardware and configuration settings.
Keys of Interest:

PHANTOM: This key often relates to "phantom" devices, which are hardware devices no longer connected but still detected in the registry.
CONFIGFLAGS: This key contains configuration settings for devices. It might be used to enable, disable, or modify device behavior.
FRIENDLYNAME: Provides a human-readable name for the device (e.g., "VMware SATA CD-ROM").
PROPERTIES: Typically, this contains specific property data about a device or component, identified by GUIDs (Globally Unique Identifiers).
Device Identifiers:

The paths mention hardware device names, indicating these are associated with virtual machines (VMs):
VirtualBox: A popular virtualization platform.
VMware: Another major virtualization platform.
Specific components include:
VirtualBox as MFG_INNOTEK_GMBH and PROD_VIRTUAL_MACHINE.
VMware as MFG_VMWARE__INC. and PROD_VMWARE7_1.
GUIDs:

{83DA6326-97A6-4088-9453-A1923F573B29} and {A8B865DD-2E3D-4094-AD97-E593A70C75D6}:
These GUIDs likely correspond to specific properties or metadata associated with devices, such as configuration data, device descriptors, or unique identifiers.
mmc.exe:

Microsoft Management Console (mmc.exe): A core Windows process used for managing and configuring system components. The references imply mmc.exe is querying or modifying these registry keys.
Breakdown of the Code:
Each line reflects a query or action on a registry path and key:

VirtualBox Phantom Device:

Paths referencing MFG_INNOTEK_GMBH&FAM_VIRTUAL_MACHINE&PROD_VIRTUALBOX and the key PHANTOM suggest:
Detecting or interacting with a "phantom" VirtualBox device.
These may be used to confirm the presence of VirtualBox, even if the actual VM is no longer active.
VMware Devices:

Paths referencing MFG_VMWARE__INC. or VEN_VMWARE indicate registry interactions with VMware devices, such as:
VMWARE_SATA_HAR (Virtual VMware SATA Hard Disk).
VMWARE_SATA_CD01 (Virtual VMware SATA CD-ROM).
Keys like FRIENDLYNAME suggest these operations retrieve user-friendly names for the devices.
Device Configuration:

The CONFIGFLAGS key suggests mmc.exe might be querying or modifying device configuration data, such as enabling or disabling devices.
GUID-Based Properties:

Operations on paths like PROPERTIES\{GUID} with empty keys indicate property retrieval or checks for device-specific metadata.
Purpose:
These operations appear to:

Identify virtualized environments (VirtualBox and VMware).
Gather details about virtual devices via their properties and metadata.
Potentially configure or modify system interaction with these virtual devices.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Reads Registry for VMWare Artifacts

"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")


Breakdown:

These entries detail a series of operations involving the Windows Registry and the process mmc.exe (Microsoft Management Console), which is interacting with specific paths related to VMware virtual devices. Letâ€™s analyze these in sections for clarity:

General Context:
mmc.exe (Microsoft Management Console):

A core Windows system utility used to manage and monitor hardware, software, and Windows components.
The registry interactions suggest that mmc.exe is querying or potentially modifying registry keys associated with VMware virtual hardware.
Registry Hive:

All entries fall under the path HKLM\SYSTEM\CONTROLSET001\ENUM\, which contains configuration information about devices recognized by Windows.
Target Devices:

VMware Virtual Devices:
VEN_NECVMWAR: Represents VMware virtual CD-ROM drives.
VEN_VMWARE: Represents VMware virtual SATA hard drives.
MFG_VMWARE__INC.: Represents VMware virtual machine descriptions.
Keys and Properties:

CONFIGFLAGS:
Configuration settings for devices, typically indicating status (e.g., enabled, disabled).
FRIENDLYNAME:
Human-readable names for devices (e.g., "VMware Virtual CD-ROM").
PROPERTIES\{GUID}:
Metadata or specific device properties identified by a unique GUID.

Specific Registry Interactions:
Virtual CD-ROM (VEN_NECVMWAR):
Path: HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000
This registry path corresponds to a VMware virtual CD-ROM device.

Operations:
Query the friendly name (via the FRIENDLYNAME key).
Retrieve configuration flags (via the CONFIGFLAGS key).
Query specific properties (e.g., {CF73BB51-3ABF-44A2-85E0-9A3DC7A12132} and {A8B865DD-2E3D-4094-AD97-E593A70C75D6}):
{CF73BB51...}: Likely related to device-specific details or status.
{A8B865DD...}: Likely contains additional metadata or extended device attributes.
Virtual Hard Drive (VEN_VMWARE):
Path: HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000
This corresponds to a VMware virtual SATA hard disk.

Operations:
Query friendly name (via the FRIENDLYNAME key).
Retrieve configuration flags (via the CONFIGFLAGS key).
Query specific properties (e.g., {CF73BB51...}, {A8B865DD...}):
{CF73BB51...}: Potentially related to hardware-specific configuration or attributes.
{A8B865DD...}: Likely extended device metadata or descriptors.
Virtual Machine (MFG_VMWARE__INC.):
Path: HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1
This corresponds to the virtual machine descriptor for VMware.
Operations:
Query friendly name (via the FRIENDLYNAME key).
Retrieve configuration flags (via the CONFIGFLAGS key).
Query specific properties (e.g., {CF73BB51...}, {A8B865DD...}):
Likely used to fetch metadata about the VM environment.

Key Observations:
Purpose:

These registry interactions suggest a detailed inspection of VMware virtual hardware and virtual machine properties.
Possible reasons:
System diagnostics or hardware management.
Determining if the environment is running on a virtual machine.
Retrieving metadata for system reporting or logging.
Focus on VMware:

The consistent reference to VMware components indicates these scripts or operations are targeting VMware virtual environments specifically.
GUID-Based Properties:

{CF73BB51...} and {A8B865DD...}:
Likely identifiers for extended device-specific properties.
{A8B865DD...} is queried multiple times, indicating it contains essential metadata or flags.
Security Implications:

Such operations could be used by:
System administrators for monitoring and diagnostics.
Malware to detect virtualization environments and avoid analysis in a sandboxed VM.

Summary:
The operations by mmc.exe involve querying, retrieving, and possibly modifying registry entries for VMware virtual devices. These scripts seem to target specific components of a virtualized environment, focusing on their configuration and properties. This could be used for administrative purposes, environment detection, or other system-level interactions.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Reading Registry for Certain VMWare Artifacts

"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "CONFIGFLAGS")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1"; Key: "FRIENDLYNAME")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{CF73BB51-3ABF-44A2-85E0-9A3DC7A12132}\0006")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01\5&354AE4D7&0&010000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR\5&354AE4D7&0&000000\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0005")
"mmc.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1\PROPERTIES\{A8B865DD-2E3D-4094-AD97-E593A70C75D6}\0014")


Breakdown:

Registry Paths and Keys Analyzed
HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\CDROM&VEN_NECVMWAR&PROD_VMWARE_SATA_CD01

This path relates to a virtual CD/DVD drive created by VMware virtual machines.
Keys like CONFIGFLAGS, FRIENDLYNAME, and {GUID} properties store configuration settings, human-readable names, and additional metadata about the device.
HKLM\SYSTEM\CONTROLSET001\ENUM\SCSI\DISK&VEN_VMWARE&PROD_VIRTUAL_SATA_HAR

This represents a virtual hard disk in a VMware environment.
Similar to the CD/DVD drive path, it contains configuration flags and metadata properties.
HKLM\SYSTEM\CONTROLSET001\ENUM\SWD\COMPUTER\MFG_VMWARE__INC.&PROD_VMWARE7_1

This pertains to the virtual machine instance itself, detailing its manufacturer (VMware) and associated hardware properties.
Keys like {CF73BB51-3ABF-44A2-85E0-9A3DC7A12132} and {A8B865DD-2E3D-4094-AD97-E593A70C75D6}

These GUIDs typically represent device properties, such as hardware IDs, device capabilities, and software driver information.
Observed Behavior
mmc.exe is being executed to query or manage these specific registry entries related to:

Virtual CD/DVD drives
Virtual hard disks
VMware hardware information
Keys like CONFIGFLAGS and FRIENDLYNAME provide:

Configuration Flags: Control whether the device is enabled, disabled, or has specific behavior.
Friendly Names: User-readable labels for devices.
What This Means
Legitimate Uses:

If you are in a VMware virtual environment, this is likely a normal activity where mmc.exe interacts with registry entries to manage virtual devices or hardware.
System administrators or applications may call mmc.exe to verify, configure, or monitor virtual devices.
Potential Malicious Indicators:

If mmc.exe is running unexpectedly or being invoked by unknown processes, it could indicate:
Registry reconnaissance by malware or an attacker.
Attempts to manipulate VMware-related configurations.

Summary:

This mmc.exe executable is the Microsoft Management Console, a legitimate Windows system utility used to manage various administrative tasks and system configurations. However, the behavior of mmc.exe can indicate malicious activity as it can be manipulated or called by unauthorized processes.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Calls an API used to execute an application

"MEMZ_1_.exe" called "ShellExecuteW" with parameter C:\MEMZ_1_.exe (UID: 00000000-00008760)
"MEMZ_1_.exe" called "ShellExecuteA" with parameter notepad (UID: 00000000-00004068)
"MEMZ_1_.exe" called "ShellExecuteA" with parameter http://google.co.ck/search?q=stanky+danky+maymays (UID: 00000000-00004068)
"MEMZ_1_.exe" called "ShellExecuteA" with parameter devmgmt.msc (UID: 00000000-00004068)
"MEMZ_1_.exe" called "ShellExecuteA" with parameter http://google.co.ck/search?q=facebook+hacking+tool+free+download+no+virus+working+2016 (UID: 00000000-00004068)
"MEMZ_1_.exe" called "ShellExecuteA" with parameter http://google.co.ck/search?q=mcafee+vs+norton (UID: 00000000-00004


Breakdown:


ShellExecuteA with parameter "notepad"
-Launches the Notepad application.
-Harmless on its own but used by MEMZ for distractions or to present prank messages.

ShellExecuteA with parameter "http://google.co.ck/search?q=stanky+danky+maymays"
-Opens a browser to a Google search query.
-This is a prank payload aiming to confuse or annoy the user. The humorous search term is a hallmark of MEMZ.

ShellExecuteA with parameter "devmgmt.msc"
-Attempts to open the Device Manager.
-This could be used as a distraction or part of a payload that draws the user's attention to system configurations.

ShellExecuteA with parameter "http://google.co.ck/search?q=facebook+hacking+tool+free+download+no+virus+working+2016"
-Opens a browser to another humorous and questionable Google search query.
-Designed to embarrass, confuse, or amuse.

ShellExecuteA with parameter "http://google.co.ck/search?q=mcafee+vs+norton"
-Yet another browser redirection.
-The intent here seems to mock antivirus programs with a meme-based search query.

Summary:
The trojan uses various payloads, often with humorous or chaotic behavior, including spawning websites, displaying messages, or disrupting the operating system.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Sets a computer based training CBT Hook

"MEMZ_1_.exe" sets a callback procedure (281ae2) using filter "WH_CBT" for process ID: 1d54
"MEMZ_1_.exe" sets a callback procedure (281ae2) using filter "WH_CBT" for process ID: 1f68
"MEMZ_1_.exe" sets a callback procedure (281ae2) using filter "WH_CBT" for process ID: 62c


Breakdown:

Callback Procedures
-A callback procedure is a function registered to respond to specific system events or messages. In this context, the WH_CBT filter is being used.

"WH_CBT Filter"
-The WH_CBT (Computer-Based Training) hook filter is part of the Windows Hook mechanism.
-It allows a program to monitor and respond to system-level events such as:
 Window creation, activation, or destruction.
 Mouse or keyboard input.
 System messages like focus changes or resizing.

Processes IDs (PID)
The listed PIDs (1d54, 1f68, and 62c) correspond to running processes on the system that MEMZ is targeting for callback registration.
These processes might be specific system or user applications.

Behavior Analysis
-The command executable is setting hooks on processes
-By setting hooks using WH_CBT, MEMZ_1_.exe is likely monitoring or interfering with system events for specific processes.


Potential Uses
-For Pranks:
 Disrupting or modifying user interactions, such as:
 Blocking or altering window behavior.
 Forcing focus to certain windows.
 Injecting prank payloads (e.g., popups, animations).

-For Malicious Purposes:
 Logging sensitive user interactions.
 Altering or disabling system functionality.
 Callback Procedure (281ae2)

The hexadecimal address (281ae2) represents the memory location where MEMZ has registered its callback function.
This is the function responsible for handling the hooked events.

Summary:
The provided activity logs show that MEMZ_1_.exe is setting callback procedures using the WH_CBT filter for different process IDs. This behavior is characteristic of programs attempting to manipulate or monitor system events, often for malicious or prank-related purposes.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Writes data to a remote process

"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 1316)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 964)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 968)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 1348)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 1384)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\MEMZ_1_.exe" (Handle: 1320)
"MEMZ_1_.exe" wrote 00000004 bytes to a remote process "C:\Windows\SysWOW64\mmc.exe" (Handle: 1560)
"Notepad.exe" wrote 000011C0 bytes to a remote process "%PROGRAMFILES%\WindowsApps\Microsoft.WindowsNotepad_11.2309.28.0_x64__8wekyb3d8bbwe\Notepad\Notepad.exe" (Handle: 844)
"Notepad.exe" wrote 00000008 bytes to a remote process "C:\Program Files\WindowsApps\Microsoft.WindowsNotepad_11.2309.28.0_x64__8wekyb3d8bbwe\Notepad\Notepad.exe" (Handle: 844)


Breakdown:

General Observations
Process: MEMZ_1_.exe is writing 4 bytes to multiple processes, including instances of itself and the legitimate system utility mmc.exe.
Handles: These refer to active references to processes or resources, allowing MEMZ to perform operations on these processes.

Specific Actions:

Writing to Itself of 4 bytes to multiple handles of C:\MEMZ_1_.exe is likely a form of process self-injection or process duplication
-To execute a payload or maintain persistence within its own processes.
-To confuse or evade detection by security software.

Mechanism: 

Writing a small amount of data (4 bytes) could be a marker, a control signal, or part of its payload logic.
Writing to mmc.exe

Writing data to a system process (C:\Windows\SysWOW64\mmc.exe) could indicate an attempt at process injection:
-Of Hijacking mmc.exe to run malicious code under the guise of a legitimate process.
-Using mmc.exe as a launch point for payloads or privilege escalation.

Danger: 

-If successful, this can be used to hide malicious behavior or compromise system integrity.
Notepad.exe Activity Analysis


Process: 

Notepad.exe writes larger amounts of data (e.g., 11C0 and 8 bytes) to a remote Notepad process.
IPC: Likely a part of legitimate inter-process communication for Notepad (e.g., opening or editing a file across instances).
Unusual Context: If MEMZ is involved, this could also be manipulated behavior for:
Creating distractions (e.g., spam Notepad windows or messages).
Using Notepad as a decoy process for other activities.
Potential Malicious Techniques at Play
Process Injection

Writing to other processes (including itself and mmc.exe) strongly suggests an attempt at injecting code or modifying memory of other processes.
Techniques Could Include:
Writing shellcode or small payloads for execution.
Hijacking thread execution to run malicious functions.
Utilizing trusted processes to evade detection.
Self-Replication

Writing to itself (MEMZ_1_.exe) can be a way of replicating its code to new instances or preserving its functionality after detection attempts.
Payload Delivery

The 4-byte writes might be initialization markers or instructions to synchronize behavior across processes.
Distraction or Evasion

Interaction with Notepad processes could be used to:
Distract the user with multiple open windows.
Use Notepad as a cover for more malicious activities.

Summary:

This activity log indicates actions involving MEMZ_1_.exe and Notepad.exe writing data to other processes. The actions can be indicative of process injection, inter-process communication (IPC), or manipulation.

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Spawns a multitude of processes

Spawned process "MEMZ_1_.exe" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/watchdog" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/watchdog" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/watchdog" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/watchdog" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/watchdog" (Show Process)
Spawned process "MEMZ_1_.exe" with commandline "/main" (Show Process)
Spawned process "Notepad.exe" with commandline "\\note.txt" (Show Process)
Spawned process "Notepad.exe" with commandline "/SESSION:GqvNjHRY/0uwZuveb+eQjQELQwA6AFwAbgBvAHQAZQAuAHQAeAB0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEKAAAAAaRADAMAAAAAAAA=" (Show Process)
Spawned process "identity_helper.exe" with commandline "--type=utility --utility-sub-type=winrt_app_id.mojom.WinrtAppIdService --lang=en-US --service-sandbox-type=none --mojo-platform-channel-handle=6136 --field-trial-handle=2532,i,1321437477151538021,267581475079639704,262144 /prefetch:8" (Show Process)
Spawned process "identity_helper.exe" with commandline "--type=utility --utility-sub-type=winrt_app_id.mojom.WinrtAppIdService --lang=en-US --service-sandbox-type=none --mojo-platform-channel-handle=6136 --field-trial-handle=2532,i,1321437477151538021,267581475079639704,262144 /prefetch:8" (Show Process)
Spawned process "mmc.exe" with commandline ""%WINDIR%\\System32\\devmgmt.msc"" (Show Process)
Spawned process "mmc.exe" with commandline ""%WINDIR%\\System32\\devmgmt.msc" "%WINDIR%\\System32\\devmgmt.msc""


Breakdown:

Primary Process:
MEMZ_1_.exe spawns multiple instances of itself and other programs like Notepad, MMC, and an identity helper.
Commands like /watchdog and /main indicate potential behavior control mechanisms.
MEMZ_1_.exe with /watchdog

Purpose:
Likely a mechanism to ensure the survival of the main process or the payload. A "watchdog" process typically monitors the health of a primary process and relaunches it if terminated.
Could also serve as a failsafe to reinstate malicious operations after user interference.

Behavior:
By spawning multiple instances with /watchdog, MEMZ ensures resilience against termination.
Excessive watchdog processes can lead to resource exhaustion.
MEMZ_1_.exe with /main

Purpose:
This may represent the primary payload or operational logic of MEMZ.
Likely coordinates actions such as spawning payloads, hooks, or disruptive processes.

Processes Spawned by MEMZ_1_.exe
Notepad.exe

Commandline: \\note.txt:
This could attempt to open a file named note.txt, potentially as a distraction or to display prank content.
Commandline: /SESSION:...:
The session argument is suspicious and may indicate encoding or obfuscation.
It could represent a payload or session-related data to execute within Notepad, potentially abusing it as a host process for further actions.
identity_helper.exe

Commandline: --type=utility and other arguments:
This process appears related to Microsoft Windows identity services.
The parameters indicate interaction with WinRT APIs, likely involving Windows services or application identity management.

Potential MEMZ Role:
This process could be hijacked by MEMZ to leverage trusted system utilities for malicious purposes.
mmc.exe

Commandline: %WINDIR%\System32\devmgmt.msc:
This launches the Device Manager, a legitimate Windows system utility.

Second Commandline:
%WINDIR%\System32\devmgmt.msc "%WINDIR%\System32\devmgmt.msc" suggests recursion or an attempt to confuse or overload the utility.
Malicious Techniques at Play
Process Persistence and Monitoring

Spawning multiple /watchdog processes ensures MEMZ cannot be easily terminated.
Resource Exhaustion

The repeated spawning of processes like MMC and identity_helper.exe may lead to system resource exhaustion or instability.
Distraction

By spawning Notepad with files and suspicious command-line arguments, MEMZ may aim to distract the user from its primary operations.
Evasion via Trusted Processes

Using legitimate processes like Notepad, MMC, and identity_helper.exe helps MEMZ evade detection by security software by blending with system operations.
Potential Risks
System Instability

Multiple process spawns can lead to performance degradation or system crashes.
Persistence

The /watchdog processes ensure that MEMZ cannot be easily removed, potentially requiring advanced tools or a system restart to terminate.
Payload Execution

MEMZ might be preparing or executing its primary malicious payload through /main or obfuscated arguments in Notepad.
Evasion and Subversion

Hijacking legitimate utilities could confuse users and security measures, complicating detection and removal.

Summary:

The code snippet indicates that MEMZ_1_.exe and related processes are spawning multiple child processes, some of which seem unusual and potentially malicious or prank-related. 

------------------------------------------------------------------------------------------------------------------------------------------------------------

Code: Forces shutdown of Operating System

"MEMZ_1_.exe" called "NtRaiseHardError" with the "OptionShutdownSystem" response


Breakdown:

What is NtRaiseHardError?

This is a low-level Windows NT system call that allows a process to trigger a hard error. Hard errors are critical system-level alerts that can cause the system to display a blue screen, prompt the user with an error message, or take other significant actions.
What does OptionShutdownSystem mean?

This parameter specifies that the response to the hard error should trigger a system shutdown or restart. When used maliciously, it forces the system to stop functioning, potentially leading to data loss or corruption.
Analysis of MEMZ Behavior
Purpose of the Call

The function NtRaiseHardError with the OptionShutdownSystem response indicates an intentional attempt by MEMZ_1_.exe to forcefully shutdown or restart the operating system.
This is likely part of a disruptive or destructive payload, often used by malware for one or more of the following reasons:
Cause Chaos: Sudden shutdowns disrupt normal user activity and may lead to panic or frustration.
Data Loss: Any unsaved work or processes will be lost during the shutdown.
Cover Tracks: By shutting down the system, the malware could prevent users or administrators from analyzing its actions or logs.
Reinforce Payload Impact: Some malware includes this as a final action after executing other harmful tasks.
Potential User Impact

The user is likely to experience:
A system crash or forced restart.
Data loss from unsaved work or ongoing processes.
Difficulty in diagnosing the issue due to the abrupt shutdown.
Context in MEMZ

MEMZ Trojan is known for prank-like and destructive behaviors. Using NtRaiseHardError aligns with its nature of causing system instability and creating a chaotic user experience.
How Does NtRaiseHardError Work?
When NtRaiseHardError is invoked:

Error Message Handling:
The system receives a critical error code and evaluates the specified response option (in this case, OptionShutdownSystem).
Shutdown Trigger:
Windows executes a system-level shutdown procedure, bypassing standard user input or administrative controls.
User Experience:
Depending on the system configuration, users might:
See a blue screen or shutdown message (rare for NtRaiseHardError with this option).
Experience an immediate and forced system restart or power-off.
Malicious Intent Behind the Call
Part of a Malicious Payload:

The use of OptionShutdownSystem suggests the executable intends to be destructive or highly disruptive.
If invoked in a loop or repeatedly, it could make the system unusable.
Final Act:

This call may be triggered as a final action after executing other malicious tasks (e.g., file corruption, data exfiltration, or installing backdoors).

Summary:

The invocation of NtRaiseHardError with OptionShutdownSystem by MEMZ_1_.exe is a clear sign of malicious intent, designed to disrupt system operations. Whether part of a prank, final payload, or a cover-up mechanism, this function poses significant risks to system stability and data integrity. Immediate remediation and protective measures are essential to mitigate further damage.

